<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GALLA</title>

    <link rel="stylesheet" href="css/index.css" />
    <link rel="stylesheet" href="css/shorts.css" />
</head>

<body data-page="index">
<div id="app">

    <!-- HEADER -->
    <header class="header">
        <div class="header-inner">
            <img src="assets/logo.png" alt="GALLA" class="logo"
                 onclick="location.href='index.html'" />

            <!-- 로그인/로그아웃 전환 UI -->
            <div class="auth-buttons">
                <!-- 로그인 전 -->
                <button id="headerLoginBtn" onclick="location.href='login.html'">로그인</button>
                <button id="headerSignupBtn" onclick="location.href='signup.html'">회원가입</button>

                <!-- 로그인 후 -->
                <button id="headerMypageBtn" onclick="location.href='mypage.html'" style="display:none;">마이페이지</button>
            </div>
        </div>
    </header>

    <!-- HERO -->
    <section class="hero">
        <h1 class="hero-title">지금, 대한민국의 진짜 여론</h1>
        <p class="hero-desc">진영을 선택하고 의견을 던지고, 싸우고, 후원하라.</p>
    </section>

    <!-- CATEGORY -->
    <section class="category-section">
        <div class="chip-scroll">
            <div class="chip active" onclick="location.href='search.html?category=전체'">전체</div>
            <div class="chip" onclick="location.href='search.html?category=정치·사회'">정치·사회</div>
            <div class="chip" onclick="location.href='search.html?category=경제·투자'">경제·투자</div>
            <div class="chip" onclick="location.href='search.html?category=직장·경력'">직장·경력</div>
            <div class="chip" onclick="location.href='search.html?category=연애·결혼'">연애·결혼</div>
            <div class="chip" onclick="location.href='search.html?category=생활·일상'">생활·일상</div>
            <div class="chip" onclick="location.href='search.html?category=패션·뷰티'">패션·뷰티</div>
            <div class="chip" onclick="location.href='search.html?category=엔터·스포츠'">엔터·스포츠</div>
            <div class="chip" onclick="location.href='search.html?category=세계·여행'">세계·여행</div>
            <div class="chip" onclick="location.href='search.html?category=음식·맛집'">음식·맛집</div>
            <div class="chip" onclick="location.href='search.html?category=19금'">19금</div>
            <div class="chip" onclick="location.href='search.html?category=기타'">기타</div>
        </div>
    </section>

    <!-- BEST -->
    <section class="section">
        <div class="section-title">🔥 베스트 갈라</div>
        <div id="best-list"></div>
        <button id="best-more" class="more-list-btn" onclick="location.href='search.html?type=best'">더보기</button>
    </section>

    <!-- RECOMMENDED -->
    <section class="section">
        <div class="section-title">⭐ 오늘의 추천 갈라</div>
        <div id="recommend-list"></div>
    </section>

    <!-- 🔥 SHORTS OVERLAY -->
    <div id="shortsOverlay" hidden>
        <div class="shorts-video-wrap">
        <video id="videoPrev" playsinline></video>
        <video id="shortsVideo" playsinline></video>
        <video id="videoNext" playsinline></video>

        <div class="shorts-top">
        <button id="shortsBack">←</button>
        <div class="shorts-time">5:05</div>
        </div>

        <div class="shorts-actions">
        <div>❤️ 272</div>
        <div>💬</div>
        <div>📤</div>
        </div>
    </div>
    </div>


    </div>   <!-- #app 닫힘 -->

    <!-- NAVIGATION -->
    <nav class="nav">
        <div class="nav-inner">
            <img src="assets/icons/nav-home.svg" class="nav-icon" data-target="index.html">
            <img src="assets/icons/nav-search.svg" class="nav-icon" data-target="search.html">
            <img src="assets/icons/nav-write.svg" class="nav-icon" data-target="write.html">
            <img src="assets/icons/nav-random.svg" class="nav-icon" data-target="random.html">
            <img src="assets/icons/nav-user.svg" class="nav-icon" data-target="mypage.html">
        </div>
    </nav>

<!-- 🔴 여기부터 추가 -->
<div id="modal" class="modal">
    <div class="modal-content">
        <p id="modal-text"></p>
        <button id="modal-close">확인</button>
    </div>
</div>
<!-- 🔴 여기까지 추가 -->

<!-- Supabase Loader -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
<script src="js/supabase.js"></script>

<script>
/* ============================================================
   로그인 상태에 따라 UI 자동 변경 (모든 페이지 공통 사용)
============================================================ */
document.addEventListener("DOMContentLoaded", async () => {

    // supabaseClient 로드 대기
    function waitForSupabase() {
        return new Promise(resolve => {
            const timer = setInterval(() => {
                if (window.supabaseClient) {
                    clearInterval(timer);
                    resolve();
                }
            }, 20);
        });
    }

    await waitForSupabase();
    const supabase = window.supabaseClient;

    const { data } = await supabase.auth.getSession();
    const session = data.session;

    const btnLogin = document.getElementById("headerLoginBtn");
    const btnSignup = document.getElementById("headerSignupBtn");
    const btnMypage = document.getElementById("headerMypageBtn");

    if (session?.user) {
        // 로그인 상태
        btnLogin.style.display = "none";
        btnSignup.style.display = "none";
        btnMypage.style.display = "inline-block";
    } else {
        // 로그아웃 상태
        btnLogin.style.display = "inline-block";
        btnSignup.style.display = "inline-block";
        btnMypage.style.display = "none";
    }

    // NAVIGATION CLICK
    document.querySelectorAll(".nav-icon").forEach(icon => {
        icon.addEventListener("click", () => {
            const t = icon.dataset.target;
            if (t) location.href = t;
        });
    });
});
</script>

<script src="js/index.js"></script>
<script src="js/shorts.js"></script>

</body>
</html>