<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입 - GALLA</title>

    <link rel="stylesheet" href="./css/index.css">
    <link rel="stylesheet" href="./css/signup.css">
    <link rel="stylesheet" href="./css/nav.css">
</head>

<body data-page="signup">

<div id="app">

    <!-- HEADER -->
    <header class="header">
        <div class="header-inner">
            <img src="assets/icons/back.svg" class="back-icon" onclick="goBackWithScroll()">
            <div class="header-title">회원가입</div>
            <div class="header-spacer"></div>
        </div>
    </header>

    <div class="signup-guide">
        GALLA는 여론이 에너지(GP)로 변환되는 플랫폼입니다.<br>
        모든 정보를 입력하면 추천·보상 기능이 강화되고,<br>
        활동으로 획득한 GP는 향후 수익화 프로그램 참여에도 사용됩니다.
    </div>

    <section class="section">

        <div class="input-group">
            <div class="input-label">아이디 (이메일 주소) <span class="req">*</span></div>
            <input type="email" id="email" class="input-field" placeholder="example@galla.com">
        </div>

        <div class="input-group">
            <div class="input-label">비밀번호 <span class="req">*</span></div>
            <input type="password" id="password" class="input-field" placeholder="비밀번호 입력">
        </div>

        <div class="input-group">
            <div class="input-label">비밀번호 확인 <span class="req">*</span></div>
            <input type="password" id="password2" class="input-field" placeholder="비밀번호 다시 입력">
        </div>

        <div class="input-group">
            <div class="input-label">닉네임 (활동명) <span class="req">*</span></div>
            <input type="text" id="nickname" class="input-field" placeholder="갈라에서 사용할 이름">
        </div>

        <div class="input-group">
            <div class="input-label">휴대폰 번호 (선택 — 정산 시 필요)</div>
            <input type="tel" id="phone" class="input-field" placeholder="010-0000-0000">
        </div>

        <div class="input-label">사는 지역 (선택)</div>

        <div class="region-grid">
            <div class="region-chip">서울</div>
            <div class="region-chip">부산</div>
            <div class="region-chip">대구</div>
            <div class="region-chip">인천</div>
            <div class="region-chip">광주</div>
            <div class="region-chip">대전</div>
            <div class="region-chip">울산</div>
            <div class="region-chip">세종</div>
            <div class="region-chip">경기</div>
            <div class="region-chip">강원</div>
            <div class="region-chip">충북</div>
            <div class="region-chip">충남</div>
            <div class="region-chip">전북</div>
            <div class="region-chip">전남</div>
            <div class="region-chip">경북</div>
            <div class="region-chip">경남</div>
            <div class="region-chip">제주</div>
            <div class="region-chip">해외</div>
        </div>

        <div class="region-selected-text">
            선택한 지역: <span id="selectedRegion">없음</span>
        </div>

        <div class="toggle-row">
            <span>익명으로 활동하기</span>
            <label class="switch">
                <input type="checkbox" id="anonymous">
                <span class="slider"></span>
            </label>
        </div>

        <div class="reward-box">
            모든 항목 입력 시 <span class="reward-gp">+50 GP</span> 지급!
        </div>

        <button class="submit-btn" id="signupBtn">회원가입</button>

    </section>

</div>

<nav class="nav">
  <div class="nav-inner">

    <button class="nav-item" data-page="index" data-target="index.html">
      <img
        src="./assets/icons/nav-home.svg"
        data-base="./assets/icons/nav-home.svg"
        data-active="./assets/icons/nav-home-active.svg"
      >
    </button>

    <button class="nav-item" data-page="search" data-target="search.html">
      <img
        src="./assets/icons/nav-search.svg"
        data-base="./assets/icons/nav-search.svg"
        data-active="./assets/icons/nav-search-active.svg"
      >
    </button>

    <button class="nav-item" data-page="write" data-target="write.html">
      <img
        src="./assets/icons/nav-write.svg"
        data-base="./assets/icons/nav-write.svg"
        data-active="./assets/icons/nav-write-active.svg"
      >
    </button>

    <button class="nav-item" data-page="plaza" data-target="plaza.html">
      <img
        src="./assets/icons/nav-plaza.svg"
        data-base="./assets/icons/nav-plaza.svg"
        data-active="./assets/icons/nav-plaza-active.svg"
      >
    </button>

    <button class="nav-item" data-page="mypage" data-target="mypage.html">
      <img
        src="./assets/icons/nav-user.svg"
        data-base="./assets/icons/nav-user.svg"
        data-active="./assets/icons/nav-user-active.svg"
      >
    </button>

  </div>
</nav>

<script src="./js/nav.js"></script>

<!-- Supabase UMD -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>

<!-- 공통 supabase 초기화 -->
<script src="./js/supabase.js"></script>

<!-- LOGIN CHECK + WAIT + signup 실행 -->
<script>
/* Supabase 로딩 대기 */
function waitForSupabaseClient() {
    return new Promise(resolve => {
        const timer = setInterval(() => {
            if (window.supabaseClient) {
                clearInterval(timer);
                resolve(window.supabaseClient);
            }
        }, 20);
    });
}

/* 로그인 상태면 접속 금지 */
(async () => {
    const supabase = await waitForSupabaseClient();
    const { data } = await supabase.auth.getSession();
    if (data.session?.user) {
        alert("이미 로그인되어 있습니다.");
        location.href = "index.html";
    }
})();
</script>

<!-- signup 기능 -->
<script src="./js/signup.js"></script>


</body>
</html>